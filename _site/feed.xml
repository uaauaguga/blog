<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-01-16T09:47:49+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Jin’s Post</title><subtitle>Notes &amp; blogs</subtitle><entry><title type="html">Probablistic Model for Sequence Analysis</title><link href="http://localhost:4000/jekyll/update/2021/11/17/motif-finding-with-probablistic-model.html" rel="alternate" type="text/html" title="Probablistic Model for Sequence Analysis" /><published>2021-11-17T16:15:22+08:00</published><updated>2021-11-17T16:15:22+08:00</updated><id>http://localhost:4000/jekyll/update/2021/11/17/motif-finding-with-probablistic-model</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/11/17/motif-finding-with-probablistic-model.html">&lt;ul&gt;
  &lt;li&gt;看了不知道多少遍总是记不清楚，详细记录一下，希望别再忘了:)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;em-algorithm-for-motif-finding&quot;&gt;EM algorithm for motif finding&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;Input data: \(n\) sequences \(X_1,X_2,...,X_n\) with different lengths&lt;/li&gt;
  &lt;li&gt;Find ungapped motif with fixed length \(w\)&lt;/li&gt;
  &lt;li&gt;\(\theta\) is the motif paramter and background paramater&lt;/li&gt;
  &lt;li&gt;There are \(m_i=L_i-w+1\) possible staring position in sequence \(X_i\) with length \(L_i\)&lt;/li&gt;
  &lt;li&gt;\(Z_{ij}\) is a binary indicator variable, indicate whether there is a motif start at position \(j\) in sequence \(i\)&lt;/li&gt;
  &lt;li&gt;Denote number of motifs in sequence \(i\) as \(Q_i=\sum_{j=1}^{m_i}Z_{ij}\).&lt;/li&gt;
  &lt;li&gt;A sequence may contains 0 motifs, 1 motifs or more than one motifs.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;oops&quot;&gt;OOPS&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;assume one occurrence per sequence&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Likelihood of a sequence given the motif position&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[\log P(X_i \mid Z_{ij}=1,\theta) = \sum_{k=0}^{w-1}I(i,j+k)^T \log p_k + \sum_{k \in \Delta_{i,j}}I(i,k)^T \log p_0\]

&lt;ul&gt;
  &lt;li&gt;Prior probability that \(Z_{ij}=1\) (motif in sequence \(i\) starts at \(j\))&lt;/li&gt;
&lt;/ul&gt;

\[P(Z_{ij} \mid \theta) = \frac{1}{m_i}\]

&lt;ul&gt;
  &lt;li&gt;Joint likelihood of sequence and motif start pisition for each seuence&lt;/li&gt;
&lt;/ul&gt;

\[P(X_i,Z_i|\theta)=P(X_i|Z_i,\theta)P(Z_i|\theta)=\prod_{j=1}^{m_{i}}[P(X_i|Z_{ij}=1,\theta)P(Z_{ij}=1|\theta)]^{Z_{ij}}\]

&lt;ul&gt;
  &lt;li&gt;Joint log likelihood for each seuence&lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}
\log P(X_i,Z_i \mid \theta) &amp;amp;=\sum_{j=1}^{m_{i}}Z_{ij}\log P(X_i|Z_{ij}=1,\theta)+\sum_{j=1}^{m_{i}}Z_{ij}\log P(Z_{ij}=1|\theta) \\
&amp;amp;=\sum_{j=1}^{m_{i}}Z_{ij}\log P(X_i|Z_{ij}=1,\theta)+ \log \frac{1}{m_i} \\

\end{align*}\]

&lt;ul&gt;
  &lt;li&gt;EM for motif finding. Denote model paramters at step \(t\) as \(\theta^{(t)}\)
s&lt;/li&gt;
  &lt;li&gt;E step: calculate \(\mathbb{E}_{Z_{ij} \mid X_i,\theta^{(t)}} Z_{ij}\),&lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}
\mathbb{E}_{Z_{ij} \mid X_i,\theta^{(t)}} Z_{ij} &amp;amp;= 1*P(Z_{ij}=1 \mid X_i,\theta^{(t)})+0*P(Z_{ij}=0 \mid X_i,\theta^{(t)}) \\
&amp;amp;=P(Z_{ij}=1 \mid X_i,\theta^{(t)}) =\frac{P(X_i,Z_{ij}=1 \mid \theta^{(t)})}{P(X_i \mid \theta^{(t)})} \\
&amp;amp;=\frac{P(X_i,Z_{ij}=1 \mid \theta^{(t)})}{\sum_{k=1}^{m}P(X_i,Z_{ij}=1 \mid \theta^{(t)})} \\
&amp;amp;=\frac{P(X_i \mid Z_{ij}=1,\theta^{(t)})P(Z_{ij}=1 \mid \theta^{(t)})}{\sum_{k=1}^{m}P(X_i \mid Z_{ik}=1,\theta^{(t)})P(Z_{ik}=1 \mid \theta^{(t)})}  \\
&amp;amp;=\frac{P(X_i \mid Z_{ij}=1,\theta^{(t)})}{\sum_{k=1}^{m}P(X_i \mid Z_{ik}=1,\theta^{(t)})} 
\end{align*}\]

&lt;ul&gt;
  &lt;li&gt;M step: replace \(Z_{ij}\) in \(\log P(X_i,Z_i \mid \theta)\) with \(\mathbb{E}_{Z_{ij} \mid X_i,\theta^{(t)}} Z_{ij}\), perform standard MLE to update \(\theta^{(t)}\) to \(\theta^{(t+1)}\)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;zoops&quot;&gt;ZOOPS&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;assume zero or one motif occurrences per dataset sequence), add parameter \(\gamma\), probability that a sequence contains a motif. \(\lambda_i=\frac{\gamma}{m_i}\) is prior probabaility that any position in a sequence is start of a motif&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Likelihood of a sequence contain one motif, given the motif position is same as OOPS&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Likelihood of a sequence without a motif&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[P(X_i \mid Q_i=0,\theta) = \prod_{k=1}^{L}p_{X_{i,k},0}\]

&lt;ul&gt;
  &lt;li&gt;Joint likelihood of sequence and motif start pisition for each seuence&lt;/li&gt;
&lt;/ul&gt;

\[P(Q_i \mid \theta, \gamma) = \gamma^{Q_i}(1-\gamma)^{1-Q_i}\]

\[P(Z_{ij}=1 \mid Q_i=1, \theta)=\frac{1}{m_i}\]

&lt;ul&gt;
  &lt;li&gt;Joint log-likelihood&lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}
P(X_i,Z_i|\theta,\gamma)&amp;amp;=P(X_i,Z_i,Q_i|\theta,\gamma)\\
&amp;amp;=P(Q_i|\theta,\gamma)P(X_i,Z_i|Q_i,\theta,\gamma) \\
&amp;amp;=(1-\gamma)^{1-Q_i}P(X_i \mid Q_i=0)^{1-Q_i}\gamma^{Q_i}\prod_{j=1}^{m_{i}}[P(Z_{ij}=1 \mid Q_i=1,\theta)P(X_i \mid Z_{ij}=1,Q_i=1,\theta)]^{Z_{ij}} \\
&amp;amp;=(1-\gamma)^{1-Q_i}P(X_i \mid Q_i=0)^{1-Q_i}\gamma^{Q_i}\prod_{j=1}^{m_{i}}[\frac{1}{m_i} P(X_i \mid Z_{ij}=1,\theta)]^{Z_{ij}} 
\end{align*}\]

\[\begin{align*}
\log P(X_i,Z_i|\theta,\gamma)&amp;amp;=Q_i \log \frac{\gamma}{m_i} + (1-Q_i )\log (1-\gamma) + (1-Q_i) \log P(X_i|Q_i=0) \\
&amp;amp; + \sum_{j=1}^{m_{i}}Z_{ij}\log P(X_i|Z_{ij}=1,\theta) 
\end{align*}\]

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;EM for motif finding&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;E step: calculate \(\mathbb{E}_{Z_{ij} \mid X_i,\theta^{(t)}} Z_{ij}\)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}
\mathbb{E}_{Z_{ij} \mid X_i,\theta^{(t)}} Z_{ij} 
&amp;amp;= P(Z_{ij}=1 \mid X_i,\theta^{(t)}) = \frac{P(X_i,Z_{ij}=1 \mid \theta^{(t)})}{P(X_i \mid \theta^{(t)})} \\
&amp;amp;= \frac{P(X_i,Z_{ij}=1 \mid \theta^{(t)})}{P(X_i, Q_i=0 \mid \theta^{(t)}) + P(X_i, Q_i=1 \mid \theta^{(t)})} \\
&amp;amp;= \frac{\frac{\gamma}{m_i} P(X_i \mid Z_{ij}=1,\theta^{(t)})}{P(X_i \mid Q_i=0, \theta^{(t)})(1-\gamma) + \frac{\gamma}{m_i} \sum_{k}^{m_i} P(X_i \mid Z_{ik}=1, \theta^{(t)})}
\end{align*}\]

&lt;h3 id=&quot;tcm&quot;&gt;TCM&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;two component mixture, motif can start at any feasible positions&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Joint likelihood of sequence and motif start pisition for each seuence
\(\begin{align*}
P(X_i,Z_i|\theta,\lambda)&amp;amp;=P(X_i,Z_i|\theta,\lambda)\\
&amp;amp;=\prod_{j=1}^{m_i}\lambda^{Z_{ij}}(1-\lambda)^{1-Z_{ij}}P(X_{ij} \mid Z_{ij}=1)^{Z_{ij}}P(X_{ij} \mid Z_{ij}=0)^{1-Z_{ij}} 
\end{align*}\)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Joint log-likelihood
\(\begin{align*}
\log P(X_i,Z_i|\theta,\lambda) =  \sum_{j=1}^{m} [Z_{ij} \log \lambda +(1- Z_{ij}) \log (1-\lambda) + (1-Z_{ij}) \log P(X_{ij} \mid Z_{ij}=0) + Z_{ij} \log P(X_{ij} \mid Z_{ij}=1)]
\end{align*}\)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;hmm&quot;&gt;HMM&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;\(N\) is length of the observation&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;\(n\) is number of hidden states&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Hidden state \(Q\):&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[q_{1},q_{2},...,q_{t},...q_{N}\]

&lt;ul&gt;
  &lt;li&gt;Emitted symbol \(O\):&lt;/li&gt;
&lt;/ul&gt;

\[o_{1},o_{2},...,o_{t},...,o_{N}\]

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Transition probability matrix \(A_{N \times N}\). \(a_{st} = A_{st}\) is transition probability from state \(s\) to \(t\)&lt;/p&gt;

\[a_{st} = P(q_{i}=t \mid q_{i-1}=s)\]
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Initial probability distribution of hidden states \(\pi\) or transition probability from a slilent starting state to state \(p_i\)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[\pi_{1},\pi_{2},...,\pi_{t},...\pi_{N}\]

&lt;ul&gt;
  &lt;li&gt;Probability of emitting symbol \(b\) at state \(k\)&lt;/li&gt;
&lt;/ul&gt;

\[e_{k}(b)=P(x_{i}=b \mid q_{i}=k)\]

&lt;h3 id=&quot;forward-algorithm-inference&quot;&gt;Forward algorithm (inference)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Determine the likelihood of an observed series, marginalized for all possible hidden states&lt;/li&gt;
  &lt;li&gt;Define the forward variable \(\alpha_{t}(j)\), that is given model parameter, the joint probability of being state \(j\) at time \(t\) with observation series \(o_1,o_2,...,o_t\)&lt;/li&gt;
&lt;/ul&gt;

\[\alpha_{t}(j)=P(o_1,o_2,...,o_t,q_t=j \mid \lambda)\]

&lt;ul&gt;
  &lt;li&gt;We have (\(\lambda\) is omitted)&lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}

P(o_1,o_2,...,o_t,q_t=j) =&amp;amp; \sum_{i=1}^{N} P(o_1,o_2,...,o_{t-1},o_t,q_{t-1}=i, q_t=j) \\
=&amp;amp; \sum_{i=1}^{N} P(o_1,o_2,...,o_{t-1},q_{t-1}=i \mid \lambda)P(q_t = j \mid q_{t-1}=i)P(o_t \mid q_t = j) \\
=&amp;amp; \sum_{i=1}^{N} \alpha_{t-1}(i)a_{ij} e_{i}(o_t)
\end{align*}\]

&lt;ul&gt;
  &lt;li&gt;Initialization&lt;/li&gt;
&lt;/ul&gt;

\[\alpha_{1}(j)= \pi_{j}e_{j}(o_1)\]

&lt;ul&gt;
  &lt;li&gt;\(\alpha_{t}(j)\) can be determined by dynamic programming&lt;/li&gt;
&lt;/ul&gt;

\[\alpha_{t}(j)=\sum_{i=1}^{N} \alpha_{t-1}(i)a_{ij} e_{i}(o_t)\]

&lt;ul&gt;
  &lt;li&gt;Marginalize across last hidden state&lt;/li&gt;
&lt;/ul&gt;

\[P(O|\lambda) = \sum_{i=1}^{N}\alpha_{T}(i)\]

&lt;h3 id=&quot;viterbi-algorithm-decoding&quot;&gt;Viterbi algorithm (decoding)&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Find the most probable path of hidden states, given the model and observation&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Define the Viterbi variable&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[V_{t}(j)=\max_{q_1,q_2,...,q_{t-1}}P(o_1,o_2,...,o_t,q_t=j \mid \lambda)\]

&lt;ul&gt;
  &lt;li&gt;The intialization is same as forward algorithm&lt;/li&gt;
&lt;/ul&gt;

\[V_{1}(j)= \pi_{j}e_{j}(o_1)\]

&lt;ul&gt;
  &lt;li&gt;A dynamic programming similar to forward algorithm (the difference is replace \(\sum\) operator with \(\max\) operator) is used to calculate viterbi variable&lt;/li&gt;
&lt;/ul&gt;

\[V_t(j)=\max_{i=1}^{N}V_{t-1}(i)a_{ij} e_{i}(o_t)\]

&lt;ul&gt;
  &lt;li&gt;Keep track of the “best” hidden state, main a backtrace pointer matrix&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;model-training&quot;&gt;Model training&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Estimation HMM parameter from observations&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;baumwelch-algorithm-forward-backward-algorithm-based-em-style-training&quot;&gt;Baum–Welch algorithm: forward-backward algorithm based, EM style training&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Define backward variable \(\beta_{t}(i)\)&lt;/li&gt;
&lt;/ul&gt;

\[\beta_{t}(i)=P(o_{t+1},o_{t+2},...,o_{T}|q_{t}=i,\lambda)\]

&lt;ul&gt;
  &lt;li&gt;Similar to forward variable, we have&lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}

P(o_{t+1},o_{t+2},...,o_{T}|q_{t}=i) =&amp;amp; \sum_{j=1}^{N} P(o_{t+1},o_{t+2},...,o_T,q_{t+1}=j \mid q_t=i) \\
=&amp;amp; \sum_{j=1}^{N} P(o_{t+1},o_{t+2},...,o_T \mid q_{t+1}=j, q_t=i)  P(q_{t+1}=j \mid q_{t}=i) \\
=&amp;amp; \sum_{j=1}^{N} P(o_{t+1},o_{t+2},...,o_T \mid q_{t+1}=j)  P(q_{t+1}=j \mid q_{t}=i) \\
=&amp;amp;  \sum_{j=1}^{N}  P(o_{t+2},...,o_T \mid q_{t+1}=j) P(o_{t+1} \mid q_{t+1}=j) P(q_{t+1}=j \mid q_{t}=i) \\
= &amp;amp; \sum_{j=1}^{N} \beta_{t+1}(j) e_{j}(o_{t+1}) a_{ij}

\end{align*}\]

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;We can use backward algorithm as an alternative to forward algorithm for calculating \(P(O \mid \lambda)\)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Initialization (last observation in each instance always transit to ending state with probability 1 regardless of the hidden state \(q_T\))&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[\beta_{T}(i) = 1\]

&lt;ul&gt;
  &lt;li&gt;Recursion&lt;/li&gt;
&lt;/ul&gt;

\[\beta_{t}(i)=\sum_{j=1}^{N} \beta_{t+1}(j) e_{j}(o_{t+1}) a_{ij}\]

&lt;ul&gt;
  &lt;li&gt;Termination (exact same as the recursion fumula if we add a silent starting state corresponds to \(t=0\))&lt;/li&gt;
&lt;/ul&gt;

\[P(O|\lambda)=\sum_{j=1}^{N} \beta_{1}(j)e_{j}(o_{1})\pi_j\]

&lt;ul&gt;
  &lt;li&gt;The forward-backward algorithm&lt;/li&gt;
&lt;/ul&gt;

\[\hat{a}_{ij} = \frac{E(count\,of\,i \Rightarrow j\,transitions)}{E(count\,of\,i \Rightarrow .\,transitions)}\]

&lt;ul&gt;
  &lt;li&gt;To compute such expectation, we define a forward-backward variable&lt;/li&gt;
&lt;/ul&gt;

\[\xi_{t}(i,j)=P(q_t=i,q_{t+1}=j \mid O,\lambda)\]

&lt;ul&gt;
  &lt;li&gt;Note&lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}
P(q_t=i,q_{t+1}=j, O\mid \lambda) 
=&amp;amp;P(o_1,o_2,...,o_t,q_t=j \mid \lambda) \\ &amp;amp;(q_{t+1}=j|q_t=i)P(o_{t+1}|q_{t+1}=j) \\ &amp;amp;P(o_{t+2},...,o_{T}|q_{t+1}=i,\lambda) \\
=&amp;amp;\alpha_{t}(i)a_{ij}b_j(o_{t+1})\beta_{t+1}(j) \\
\end{align*}\]

\[\begin{align*}
P(O\mid \lambda) =&amp;amp; \sum_{j=1}^{N} P(O,q_t =j \mid \lambda) \\
=&amp;amp; P(o_1,o_2,...,o_t,q_t=j \mid \lambda) \\ &amp;amp;P(o_{t+1},o_{t+2},...,o_{T} \mid q_{t}=j,\lambda) \\
=&amp;amp; \alpha_{t}(j)\beta_{t}(j)
\end{align*}\]

&lt;ul&gt;
  &lt;li&gt;Hence&lt;/li&gt;
&lt;/ul&gt;

\[\begin{align*}
\xi_{t}(i,j) 
=&amp;amp; P(q_t=i,q_{t+1}=j \mid O,\lambda) \\
=&amp;amp; \frac{P(q_t=i,q_{t+1}=j, O\mid \lambda)}{P(O \mid \lambda)} \\
=&amp;amp; \frac{\alpha_{t}(i)a_{ij}b_j(o_{t+1})\beta_{t+1}(j)}{\sum_{j=1}^{N}\alpha_{t}(j)\beta_{t}(j)}

\end{align*}\]

&lt;h2 id=&quot;profile-hmm&quot;&gt;Profile HMM&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;A spacial HMM primarily used for protein homolog modeling&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;The hidden states in a profile HMM for local alignment, with N key positions
    &lt;ul&gt;
      &lt;li&gt;start state&lt;/li&gt;
      &lt;li&gt;insertion state 0, modeling left flanking background sequence&lt;/li&gt;
      &lt;li&gt;match state at key position 1, insertion state at key position 1, deletion state at key position 1&lt;/li&gt;
      &lt;li&gt;…&lt;/li&gt;
      &lt;li&gt;match state at key position N, insertion state at key position N (modeling right flanking background sequence), deletion state at key position N&lt;/li&gt;
      &lt;li&gt;end state&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Possible transitions
    &lt;ul&gt;
      &lt;li&gt;begin \(\Rightarrow\) insertion state 0&lt;/li&gt;
      &lt;li&gt;begin \(\Rightarrow\) deletion state at key position 1 (allow condition when first residue is missing)&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;begin \(\Rightarrow\)  match state at key position 1&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;insertion state 0 \(\Rightarrow\) insertion state 0
        &lt;ul&gt;
          &lt;li&gt;self looping for left flanking background sequence modeling&lt;/li&gt;
          &lt;li&gt;The looping probability on the flanking states should be close to 1, since they must account for long stretches of sequence&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;insertion state 0 \(\Rightarrow\) deletion state at key position 1&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;insertion state 0 \(\Rightarrow\) match state at key position 1&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;match state at key position i-1 \(\Rightarrow\) match state at key position i&lt;/li&gt;
      &lt;li&gt;insertion state at key position i-1 \(\Rightarrow\) match state at key position i&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;deletion state at key position i-1 \(\Rightarrow\) match state at key position i&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;match state at key position i-1 \(\Rightarrow\) deletion state at key position i&lt;/li&gt;
      &lt;li&gt;insertion state at key position i-1 \(\Rightarrow\) deletion state at key position i&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;deletion state at key position i-1 \(\Rightarrow\) deletion state at key position i&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;match state at key position i \(\Rightarrow\) insertion state at key position i&lt;/li&gt;
      &lt;li&gt;insertion state at key position i \(\Rightarrow\) insertion state at key position i&lt;/li&gt;
      &lt;li&gt;deletion state at key position i \(\Rightarrow\) insertion state at key position i
        &lt;ul&gt;
          &lt;li&gt;“We have added transitions between insert and delete states, as they did, although these are usually very improbable. &lt;strong&gt;Leaving them out has negligible effect on scoring a match, but can create problems when building the model from MSA&lt;/strong&gt;”&lt;/li&gt;
          &lt;li&gt;In most cases, profile HMM is constructed from MSA. Consider Figure 5.7 in &lt;a href=&quot;https://www.cambridge.org/core/books/biological-sequence-analysis/921BB7B78B745198829EF96BC7E0F29D&quot;&gt;Biological Sequence Analysis&lt;/a&gt;. We can see given a column assignment for MSA, the \(D_i \Rightarrow I_i\) transition could occur&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p style=&quot;text-align: center;&quot;&gt;&lt;img src=&quot;/images/bsa-figure-5.7.png&quot; alt=&quot;&quot; height=&quot;70%&quot; width=&quot;70%&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;match state at key position i \(\Rightarrow\) end&lt;/li&gt;
  &lt;li&gt;insertion state at key position i \(\Rightarrow\) end
    &lt;ul&gt;
      &lt;li&gt;self looping for right flanking background sequence modeling, should be close to 1&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;deletion state at key position i \(\Rightarrow\) end&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;HMM Profile searching
    &lt;ul&gt;
      &lt;li&gt;Viterbi algorithm and forward algorithm can both be used for HMM profiling searching&lt;/li&gt;
      &lt;li&gt;Viterbi: assign a mostly likely hidden state for each nucleotide, and report the corresponding likelihood&lt;/li&gt;
      &lt;li&gt;Viterbi variable for matching, insertion and deletion states at key position j and sequence position i&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[\begin{equation}
V_j^M(i) = \log{\frac{e_{M_j}(x_i)}{q_{x_i}}} + 
max \left\{
\begin{aligned}
  V_{j-1}^M(i-1) + \log a_{M_{j-1}M_j} \\
  V_{j-1}^I(i-1) + \log a_{I_{j-1}M_j}   \\
  V_{j-1}^D(i-1) + \log a_{D_{j-1}M_j}  \\
\end{aligned}
\right.
\end{equation}\]

\[\begin{equation}
V_j^I(i) = \log{\frac{e_{I_j}(x_i)}{q_{x_i}}} + 
max \left\{
\begin{aligned}
  V_{j}^M(i-1) + \log a_{M_{j}I_j} \\
  V_{j}^I(i-1) + \log a_{I_{j}I_j}   \\
  V_{j}^D(i-1) + \log a_{D_{j}I_j}  \\
\end{aligned}
\right.
\end{equation}\]

\[\begin{equation}
V_j^D(i) = 
max \left\{
\begin{aligned}
  V_{j-1}^M(i) + \log a_{M_{j-1}D_j} \\
  V_{j-1}^I(i) + \log a_{I_{j-1}D_j}   \\
  V_{j-1}^D(i) + \log a_{D_{j-1}D_j}  \\
\end{aligned}
\right.
\end{equation}\]

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;forward: assign a likelihood that the input sequence is generated from a HMM profile&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;See &lt;a href=&quot;https://notebook.community/jmschrei/pomegranate/tutorials/B_Model_Tutorial_3_Hidden_Markov_Models&quot;&gt;https://notebook.community/jmschrei/pomegranate/tutorials/B_Model_Tutorial_3_Hidden_Markov_Models&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;model-construction&quot;&gt;Model construction&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;To construct profile HMM from MSA, we have to make a decision. Each column in the MSA should either be assigned to a key position (marked column), or an insertion (unmarked column).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;For columns marked as key positions, residues are assigned to match state, gaps are assigned to deletion state&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;For columns marked as insertions, residues are assigned to insertions, gaps are ignored&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;There are \(2^L\) ways to mark a MSA with \(L\) columns.&lt;/li&gt;
  &lt;li&gt;Three ways for marking MSA columns
    &lt;ul&gt;
      &lt;li&gt;Manual&lt;/li&gt;
      &lt;li&gt;Heuristics: rule based assignment. For example, assigning all columns will more than a certain fraction of gap characters to insert states&lt;/li&gt;
      &lt;li&gt;MAP (maximum &lt;em&gt;a posteriori&lt;/em&gt;)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">看了不知道多少遍总是记不清楚，详细记录一下，希望别再忘了:)</summary></entry><entry><title type="html">Notes On Linux System Administration</title><link href="http://localhost:4000/jekyll/update/2021/11/11/note-on-linux-system-management.html" rel="alternate" type="text/html" title="Notes On Linux System Administration" /><published>2021-11-11T20:54:12+08:00</published><updated>2021-11-11T20:54:12+08:00</updated><id>http://localhost:4000/jekyll/update/2021/11/11/note-on-linux-system-management</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/11/11/note-on-linux-system-management.html">&lt;h3 id=&quot;check-avaiable-resources&quot;&gt;Check avaiable resources&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Avaliable memory: in &lt;code class=&quot;highlighter-rouge&quot;&gt;/proc/meminfo&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; free &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#              total        used        free      shared  buff/cache   available&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Mem:            30G        5.3G         18G        120M        7.4G         25G&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Swap:          8.0G        2.0G        6.0G&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;daemon-process&quot;&gt;Daemon process&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Configuration files of systemd
    &lt;ul&gt;
      &lt;li&gt;Not modify
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/lib/systemd/system&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/systemd/system&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Can be customized
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/systemd/system&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/run/systemd/system&lt;/code&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;List avaiable service&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;systemctl list-units &lt;span class=&quot;nt&quot;&gt;--type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;service
systemctl list-unit-files &lt;span class=&quot;nt&quot;&gt;--type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Show logging&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;journalctl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://askubuntu.com/questions/903354/difference-between-systemctl-and-service-commands&quot;&gt;https://askubuntu.com/questions/903354/difference-between-systemctl-and-service-commands&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ssh-login-without-typing-password&quot;&gt;ssh login without typing password&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Append local public key &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.ssh/id_rsa.pub&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;~/.ssh/authorized_keys&lt;/code&gt; in remote machine should work&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;crontab&quot;&gt;crontab&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Configuration: &lt;code class=&quot;highlighter-rouge&quot;&gt;minute(s) hour(s) day(s) month(s) weekday(s) command(s)&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/var/spool/cron/crontabs&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;See &lt;a href=&quot;https://kb.iu.edu/d/afiz&quot;&gt;https://kb.iu.edu/d/afiz&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;account-management&quot;&gt;Account management&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Add account
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;adduser&lt;/code&gt;: a system command, not create home directory&lt;/li&gt;
      &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;useradd&lt;/code&gt;: a perl wrapper for adduser, create home directory&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Remove account&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;userdel &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;user.name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Change user group&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; usermod &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;group.name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;user.name&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;network-file-system-nfs&quot;&gt;Network file system (NFS)&lt;/h3&gt;

&lt;h3 id=&quot;nis-ldap-and-single-sign-on&quot;&gt;NIS, LDAP and single sign on&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;LDAP (Lightweight Directory Access Protocol)&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;PAM (Pluggable Authentication Module system)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://blog.csdn.net/developerinit/article/details/76141065&quot;&gt;https://blog.csdn.net/developerinit/article/details/76141065&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/lfdblog/p/9803276.html&quot;&gt;https://www.cnblogs.com/lfdblog/p/9803276.html&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Show all user with access&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;getent passwd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Show password specific to LDAP&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;getent passwd &lt;span class=&quot;nt&quot;&gt;--service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ldap
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;security-related-topics&quot;&gt;Security related topics&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/var/log/secure&lt;/code&gt; provides useful loggings&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Do not log in as root&lt;/strong&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://www.liquidweb.com/kb/how-do-i-set-up-setuid-setgid-and-sticky-bits-on-linux/&quot;&gt;https://www.liquidweb.com/kb/how-do-i-set-up-setuid-setgid-and-sticky-bits-on-linux/&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">Check avaiable resources</summary></entry><entry><title type="html">Manipulate Binary Data</title><link href="http://localhost:4000/jekyll/update/2021/11/11/manipulate-binary-data.html" rel="alternate" type="text/html" title="Manipulate Binary Data" /><published>2021-11-11T20:36:17+08:00</published><updated>2021-11-11T20:36:17+08:00</updated><id>http://localhost:4000/jekyll/update/2021/11/11/manipulate-binary-data</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/11/11/manipulate-binary-data.html">&lt;h3 id=&quot;in-native-python&quot;&gt;In native python&lt;/h3&gt;

&lt;h3 id=&quot;in-numpy&quot;&gt;In numpy&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://numpy.org/doc/stable/reference/generated/numpy.packbits.html&quot;&gt;packbits&lt;/a&gt;: pack binary data into integer (np.uint8) by byte&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;low&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;high&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# generate some binary data
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_packed8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packbits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# pack every 8 bit by axis 1
# X_packed8.shape
# (1000, 4)
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_packed32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_packed8&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uint32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# X_packed32.shape
# (1000, 1)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://numpy.org/doc/stable/reference/generated/numpy.ndarray.tobytes.html&quot;&gt;tobyte&lt;/a&gt;: save numpy data to byte string&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tobytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# b'\x00\x00\x01\x00\x02\x00\x04\x00\x08\x00\x10\x00 \x00@\x00\x80\x00\x00\x01\x00\x02\x00\x04'
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://numpy.org/doc/stable/reference/generated/numpy.frombuffer.html&quot;&gt;frombuffer&lt;/a&gt;: load data from byte string&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">In native python</summary></entry><entry><title type="html">Analysis of Biological Network</title><link href="http://localhost:4000/jekyll/update/2021/11/05/inference-of-biological-network.html" rel="alternate" type="text/html" title="Analysis of Biological Network" /><published>2021-11-05T20:32:05+08:00</published><updated>2021-11-05T20:32:05+08:00</updated><id>http://localhost:4000/jekyll/update/2021/11/05/inference-of-biological-network</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/11/05/inference-of-biological-network.html">&lt;h3 id=&quot;reconstruction-of-gene-regulation-network&quot;&gt;Reconstruction of gene regulation network&lt;/h3&gt;

&lt;h3 id=&quot;network-property-and-comparison&quot;&gt;Network property and comparison&lt;/h3&gt;

&lt;h3 id=&quot;evolulation-analysis-of-biological-network&quot;&gt;Evolulation analysis of biological network&lt;/h3&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">Reconstruction of gene regulation network</summary></entry><entry><title type="html">Statistics for Sequence Alignment</title><link href="http://localhost:4000/jekyll/update/2021/10/20/statistics-for-sequence-alignment.html" rel="alternate" type="text/html" title="Statistics for Sequence Alignment" /><published>2021-10-20T14:34:51+08:00</published><updated>2021-10-20T14:34:51+08:00</updated><id>http://localhost:4000/jekyll/update/2021/10/20/statistics-for-sequence-alignment</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/10/20/statistics-for-sequence-alignment.html">&lt;h3 id=&quot;karlin-altschul-statistics&quot;&gt;Karlin-Altschul statistics&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Evaluate statistical significance of hits in blast search&lt;/li&gt;
  &lt;li&gt;1990, &lt;em&gt;PNAS&lt;/em&gt;, S Karlin &amp;amp; S F Altschul, &lt;a href=&quot;https://www.pnas.org/content/87/6/2264.long&quot;&gt;Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;The expected number of &lt;strong&gt;ungapped alignments&lt;/strong&gt; with score \(S\) found with random sequences \(E\) was demostrated to be&lt;/li&gt;
&lt;/ul&gt;

\[E(S) = Kmne^{-\lambda S}\]

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;\(m\) is length of sequence 1, \(n\) is length of sequence 2, \(K\) is a constant&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Given the substitution matrix \(S_{i,j}\), and frequency of the character \(a_{i}\) and \(a_{j}\)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

\[\sum_{i,j=1}^{r}p_{i}p_{j}e^{s_{ij} \lambda}=1\]

&lt;ul&gt;
  &lt;li&gt;Alternatively, the alignment score \(S\) follows &lt;a href=&quot;https://en.wikipedia.org/wiki/Generalized_extreme_value_distribution&quot;&gt;extreme value distribution&lt;/a&gt; (EVD), where \(u=\frac{lnKmn}{\lambda}\)&lt;/li&gt;
&lt;/ul&gt;

\[P(S&amp;lt;x)=e^{-e^{-\lambda(x-u)}}=e^{-Kmne^{-{\lambda} x}}\]

\[P(S{\geq}x)=1-P(S&amp;lt;x)=1-e^{-Kmne^{-{\lambda} x}}=1-e^{-E(x)}\]

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;\(E(S)\) can be interpreted as expected value in poisson distribution&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Readings:&lt;/p&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;http://www.bioinfo.org.cn/lectures/index-47.html&quot;&gt;http://www.bioinfo.org.cn/lectures/index-47.html&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://personal.utdallas.edu/~prr105020/biol6385/2018/lecture/Stat_sig.pdf&quot;&gt;https://personal.utdallas.edu/~prr105020/biol6385/2018/lecture/Stat_sig.pdf&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://pedagogix-tagc.univ-mrs.fr/courses/bioinfo_intro_prev/articles/sequence_alignment/Korf_BLAST_essential_OReilly.pdf&quot;&gt;http://pedagogix-tagc.univ-mrs.fr/courses/bioinfo_intro_prev/articles/sequence_alignment/Korf_BLAST_essential_OReilly.pdf&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://www.sciencedirect.com/science/article/pii/S0076687996660297?via%3Dihub&quot;&gt;https://www.sciencedirect.com/science/article/pii/S0076687996660297?via%3Dihub&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">Karlin-Altschul statistics Evaluate statistical significance of hits in blast search 1990, PNAS, S Karlin &amp;amp; S F Altschul, Methods for assessing the statistical significance of molecular sequence features by using general scoring schemes The expected number of ungapped alignments with score \(S\) found with random sequences \(E\) was demostrated to be \[E(S) = Kmne^{-\lambda S}\]</summary></entry><entry><title type="html">Tools for Annotate Genomes</title><link href="http://localhost:4000/jekyll/update/2021/10/08/tools-for-annotate-genomes.html" rel="alternate" type="text/html" title="Tools for Annotate Genomes" /><published>2021-10-08T20:17:12+08:00</published><updated>2021-10-08T20:17:12+08:00</updated><id>http://localhost:4000/jekyll/update/2021/10/08/tools-for-annotate-genomes</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/10/08/tools-for-annotate-genomes.html">&lt;h2 id=&quot;notes-on-prokaryotic-and-eukaryotic-genome-annotation&quot;&gt;Notes on Prokaryotic and Eukaryotic Genome Annotation&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Fixed Order Markov Model and Interoplated Markov Model&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Hidden Markov model&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Homolog searching&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">Notes on Prokaryotic and Eukaryotic Genome Annotation</summary></entry><entry><title type="html">Notes on Metagenomics</title><link href="http://localhost:4000/jekyll/update/2021/09/27/notes-for-metagenomics.html" rel="alternate" type="text/html" title="Notes on Metagenomics" /><published>2021-09-27T20:14:51+08:00</published><updated>2021-09-27T20:14:51+08:00</updated><id>http://localhost:4000/jekyll/update/2021/09/27/notes-for-metagenomics</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/09/27/notes-for-metagenomics.html">&lt;h3 id=&quot;metagenomic-profiling&quot;&gt;Metagenomic profiling&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Assign reads to reference sequences&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Estimate abundance of different microbes from amplicon sequencing or shutgun sequencing&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;alignment based methods vs. kmer based methods
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://huttenhower.sph.harvard.edu/metaphlan2/&quot;&gt;metaphlan2&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;kraken2&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;marker gene based methods vs. marker gene independent methods
    &lt;ul&gt;
      &lt;li&gt;metaphylan2, krakenunique&lt;/li&gt;
      &lt;li&gt;kraken2&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;nucleotide level analysis vs. protein level analysis
    &lt;ul&gt;
      &lt;li&gt;kraken2&lt;/li&gt;
      &lt;li&gt;Kaiju&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;benchmark study&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;assembly&quot;&gt;Assembly&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;metaspades: memory intensive
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://cab.spbu.ru/software/meta-spades/&quot;&gt;https://cab.spbu.ru/software/meta-spades/&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;2017, &lt;em&gt;Genome Research&lt;/em&gt;,&lt;a href=&quot;https://genome.cshlp.org/content/27/5/824.long&quot;&gt;metaSPAdes: a new versatile metagenomic assembler&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;megahit
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/voutcn/megahit&quot;&gt;https://github.com/voutcn/megahit&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;2015, &lt;em&gt;Bioinformatics&lt;/em&gt;, &lt;a href=&quot;https://academic.oup.com/bioinformatics/article/31/10/1674/177884&quot;&gt;MEGAHIT: an ultra-fast single-node solution for large and complex metagenomics assembly via succinct de Bruijn graph&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;idba-ud
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/loneknightpy/idba&quot;&gt;https://github.com/loneknightpy/idba&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;2012, &lt;em&gt;Bioinformatics&lt;/em&gt;, &lt;a href=&quot;https://academic.oup.com/bioinformatics/article/28/11/1420/266973&quot;&gt;IDBA-UD: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;strategy-for-removing-contaminations&quot;&gt;Strategy for removing contaminations&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;2014, &lt;em&gt;BMC Biology&lt;/em&gt;, &lt;a href=&quot;https://bmcbiol.biomedcentral.com/articles/10.1186/s12915-014-0087-z&quot;&gt;Reagent and laboratory contamination can critically impact sequence-based microbiome analyses&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;2019, &lt;em&gt;Trends in Microbiology&lt;/em&gt;, &lt;a href=&quot;https://www.sciencedirect.com/science/article/pii/S0966842X18302531&quot;&gt;Contamination in Low Microbial Biomass Microbiome Studies: Issues and Recommendations&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;2019, &lt;em&gt;Plos Computational Biology&lt;/em&gt;, &lt;a href=&quot;https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1006967&quot;&gt;Recentrifuge: Robust comparative analysis and contamination removal for metagenomics&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;selection-of-marker-gene&quot;&gt;Selection of marker gene&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2012, &lt;em&gt;Nature Method&lt;/em&gt;, &lt;a href=&quot;https://www.nature.com/articles/nmeth.2066&quot;&gt;Metagenomic microbial community profiling using unique clade-specific marker genes&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;Clade-specific markers are
    &lt;ul&gt;
      &lt;li&gt;coding sequences (CDSs)&lt;/li&gt;
      &lt;li&gt;strongly conserved within the clade’s genomes&lt;/li&gt;
      &lt;li&gt;not possessing substantial local similarity with any sequence outside the clade&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;taxonomic-classification&quot;&gt;Taxonomic classification&lt;/h3&gt;

&lt;h4 id=&quot;shutgun-dna-seq-and-rna-seq&quot;&gt;Shutgun DNA-seq and RNA-seq&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;marker gene based method&lt;/li&gt;
  &lt;li&gt;kmer based method&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;16s-amplicon-sequencing&quot;&gt;16S amplicon sequencing&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;quality-control&quot;&gt;Quality control&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;genome completeness&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;contamination&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;a href=&quot;https://github.com/Ecogenomics/CheckM&quot;&gt;checkM&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;2017, &lt;em&gt;NBT&lt;/em&gt;, &lt;a href=&quot;https://www.nature.com/articles/nbt.3893&quot;&gt;Minimum information about a single amplified genome (MISAG) and a metagenome-assembled genome (MIMAG) of bacteria and archaea&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;genome-similarity--clustering--remove-redundant-sequences&quot;&gt;Genome similarity &amp;amp; clustering &amp;amp; remove redundant sequences&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;mash distance&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;MUMmer whole genome alignment&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/MrOlm/drep&quot;&gt;drep&lt;/a&gt;: identify nearly duplicate genome
    &lt;ul&gt;
      &lt;li&gt;https://drep.readthedocs.io&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;distance-metrics-for-microbe-community&quot;&gt;Distance metrics for microbe community&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Bray%E2%80%93Curtis_dissimilarity&quot;&gt;Bray-Curtis distance&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/UniFrac&quot;&gt;unifrac distance&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;weighted unifrac distance&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;community-analysis-based-on-pairwise-distance&quot;&gt;Community analysis based on pairwise distance&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Multidimensional_scaling&quot;&gt;PCoA&lt;/a&gt; Analysis
    &lt;ul&gt;
      &lt;li&gt;PCoA (principle coordinate analysis) and MDS (multi-dimesional scaling) are essentially the same thing (but this seems the term MDS is seldom used by the microbiology community …)&lt;/li&gt;
      &lt;li&gt;project each sample in a distance matrix to a low dimensional space, attempt to preserve the pairwise distances&lt;/li&gt;
      &lt;li&gt;See
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;https://www.stat.pitt.edu/sungkyu/course/2221Fall13/lec8_mds_combined.pdf&quot;&gt;https://www.stat.pitt.edu/sungkyu/course/2221Fall13/lec8_mds_combined.pdf&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;https://repository.upenn.edu/cgi/viewcontent.cgi?article=1000&amp;amp;context=cis_papers&quot;&gt;https://repository.upenn.edu/cgi/viewcontent.cgi?article=1000&amp;amp;context=cis_papers&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Permutational_analysis_of_variance&quot;&gt;permanova&lt;/a&gt; analysis
    &lt;ul&gt;
      &lt;li&gt;For a given grouping (real grouping or shuffled grouping), a pseudo F statistics can be calculated&lt;/li&gt;
      &lt;li&gt;&lt;em&gt;P&lt;/em&gt; value can be calculated by shuffling group labels&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;differential-analysis&quot;&gt;Differential analysis&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;2020, &lt;em&gt;Genome Biology&lt;/em&gt;, &lt;a href=&quot;https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02104-1&quot;&gt;Assessment of statistical methods from single cell, bulk RNA-seq, and metagenomics applied to microbiome data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;functional-annotation&quot;&gt;Functional annotation&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;eggnog: &lt;a href=&quot;http://eggnog.embl.de/&quot;&gt;http://eggnog.embl.de/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;InterPro&lt;/li&gt;
  &lt;li&gt;COG&lt;/li&gt;
  &lt;li&gt;KEGG&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;genome-annotation&quot;&gt;Genome annotation&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;prokaryotes
    &lt;ul&gt;
      &lt;li&gt;Prokka&lt;/li&gt;
      &lt;li&gt;prodigal&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;eukaryotes&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/nextgenusfs/funannotate&quot;&gt;https://github.com/nextgenusfs/funannotate&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;useful-resources&quot;&gt;Useful Resources&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;sequence id to taxo-id mapping&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/&quot;&gt;ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/accession2taxid/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/joey711/phyloseq&quot;&gt;https://github.com/joey711/phyloseq&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;antibiotic-resistence-gene-finding&quot;&gt;Antibiotic resistence gene finding&lt;/h3&gt;

&lt;h3 id=&quot;plasmid-sequence-prediction&quot;&gt;Plasmid sequence prediction&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;2018, &lt;em&gt;NAR&lt;/em&gt;, &lt;a href=&quot;https://academic.oup.com/nar/article/46/6/e35/4807335&quot;&gt;PlasFlow: predicting plasmid sequences in metagenomic data using genome signatures&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;visualization&quot;&gt;Visualization&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Krona plot
    &lt;ul&gt;
      &lt;li&gt;2011, &lt;em&gt;BMC Bioinformatics&lt;/em&gt; &lt;a href=&quot;https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-12-385&quot;&gt;Interactive metagenomic visualization in a Web browser&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/marbl/Krona/tree/master/KronaTools&quot;&gt;https://github.com/marbl/Krona/tree/master/KronaTools&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/khyox/recentrifuge&quot;&gt;https://github.com/khyox/recentrifuge&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Visualization of phylogenetic tree and taxonomy tree
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://github.com/joey711/phyloseq&quot;&gt;https://github.com/joey711/phyloseq&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;ggtree&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://etetoolkit.org/&quot;&gt;http://etetoolkit.org/&lt;/a&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;conda install -c conda-forge pyqt=4&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;sankey diagram&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;a-collection-of-workflows&quot;&gt;A collection of workflows&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;2021, &lt;em&gt;Plos Computational Biology&lt;/em&gt;, &lt;a href=&quot;https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008716&quot;&gt;Metagenomics workflow for hybrid assembly, differential coverage binning, metatranscriptomics and pathway analysis (MUFFIN)&lt;/a&gt; also see &lt;a href=&quot;https://github.com/RVanDamme/MUFFIN&quot;&gt;https://github.com/RVanDamme/MUFFIN&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;2016, &lt;em&gt;Genome Biology&lt;/em&gt;, &lt;a href=&quot;https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-1116-8&quot;&gt;IMP: a pipeline for reproducible referenceindependent integrated metagenomic and metatranscriptomic analyses&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;2021, &lt;em&gt;Nature Protocol&lt;/em&gt;, &lt;a href=&quot;https://www.nature.com/articles/s41596-021-00508-2&quot;&gt;Recovering prokaryotic genomes from hostassociated, short-read shotgun metagenomic sequencing data&lt;/a&gt; https://github.com/Finn-Lab/MAG_Snakemake_wf&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;EBI’s pipeline &lt;a href=&quot;https://github.com/EBI-Metagenomics/genomes-pipeline&quot;&gt;https://github.com/EBI-Metagenomics/genomes-pipeline&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;reviews-for-reference&quot;&gt;Reviews for reference&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;2018, &lt;em&gt;Nature Review Microbiology&lt;/em&gt;, &lt;a href=&quot;https://www.nature.com/articles/s41579-018-0029-9&quot;&gt;Best practices for analysing microbiomes&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;2020, &lt;em&gt;Genome Biology&lt;/em&gt;, &lt;a href=&quot;https://genomebiology.biomedcentral.com/articles/10.1186/s13059-020-02037-9&quot;&gt;The promise and challenge of cancer microbiome research&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">Metagenomic profiling</summary></entry><entry><title type="html">latent Dirichlet allocation in genetics</title><link href="http://localhost:4000/jekyll/update/2021/08/13/latent-dirichlet-allocation.html" rel="alternate" type="text/html" title="latent Dirichlet allocation in genetics" /><published>2021-08-13T20:01:38+08:00</published><updated>2021-08-13T20:01:38+08:00</updated><id>http://localhost:4000/jekyll/update/2021/08/13/latent-dirichlet-allocation</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/08/13/latent-dirichlet-allocation.html">&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation&quot;&gt;https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.cs.columbia.edu/~blei/papers/Blei2012.pdf&quot;&gt;Probabilistic topic models&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;2003, &lt;em&gt;Journal of Machine Learning Research 3&lt;/em&gt;, &lt;a href=&quot;https://www.jmlr.org/papers/volume3/blei03a/blei03a.pdf&quot;&gt;Latent Dirichlet allocation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;2000, &lt;em&gt;Genetics&lt;/em&gt;, &lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1461096/pdf/10835412.pdf&quot;&gt;Inference of Population Structure Using Multilocus Genotype Data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">https://en.wikipedia.org/wiki/Latent_Dirichlet_allocation Probabilistic topic models 2003, Journal of Machine Learning Research 3, Latent Dirichlet allocation 2000, Genetics, Inference of Population Structure Using Multilocus Genotype Data</summary></entry><entry><title type="html">A tool for download musics from bandcamp</title><link href="http://localhost:4000/jekyll/update/2021/08/08/download-musics-from-bandcamp.html" rel="alternate" type="text/html" title="A tool for download musics from bandcamp" /><published>2021-08-08T10:24:12+08:00</published><updated>2021-08-08T10:24:12+08:00</updated><id>http://localhost:4000/jekyll/update/2021/08/08/download-musics-from-bandcamp</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/08/08/download-musics-from-bandcamp.html">&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/iheanyi/bandcamp-dl&quot;&gt;bandcamp-dl&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;There is also a more popular &lt;a href=&quot;https://github.com/ytdl-org/youtube-dl&quot;&gt;youtube-dl&lt;/a&gt; that inspires this tool …&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Worked on hongkong VPS&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;To be updated
    &lt;ul&gt;
      &lt;li&gt;Configure local proxy for downloading&lt;/li&gt;
      &lt;li&gt;Learn their implementation&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">bandcamp-dl There is also a more popular youtube-dl that inspires this tool … Worked on hongkong VPS</summary></entry><entry><title type="html">Notes on SMTP</title><link href="http://localhost:4000/jekyll/update/2021/07/31/notes-on-SMTP.html" rel="alternate" type="text/html" title="Notes on SMTP" /><published>2021-07-31T21:30:12+08:00</published><updated>2021-07-31T21:30:12+08:00</updated><id>http://localhost:4000/jekyll/update/2021/07/31/notes-on-SMTP</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2021/07/31/notes-on-SMTP.html">&lt;h2 id=&quot;play-with-smtp&quot;&gt;Play with SMTP&lt;/h2&gt;

&lt;h3 id=&quot;用telnet和smtp服务器交互在命令行发送邮件&quot;&gt;用telnet和SMTP服务器交互在命令行发送邮件&lt;/h3&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# connect to 163's SMTP server&lt;/span&gt;
telnet smtp.163.com 25
&lt;span class=&quot;c&quot;&gt;## Trying 220.181.12.18...&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## Connected to smtp.163.com.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## Escape character is '^]'.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 220 163.com Anti-spam GT for Coremail System (163com[20141201])&lt;/span&gt;
HELO fs &lt;span class=&quot;c&quot;&gt;# a shaking is required prior to sending email &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 250 OK&lt;/span&gt;
auth login &lt;span class=&quot;c&quot;&gt;# login SMTP server&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 334 dXNlcm5hbWU6 # this is a base64 encoding, validate this in python with base64.b64decode(&quot;dXNlcm5hbWU6&quot;), which return b'username:'&lt;/span&gt;
xxxxxxxxxxxx &lt;span class=&quot;c&quot;&gt;# based 64 encoded user name&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 334 UGFzc3dvcmQ6 # b'Password:'&lt;/span&gt;
xxxxxxxxxxxx &lt;span class=&quot;c&quot;&gt;# based 64 encoded user password&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 235 Authentication successful&lt;/span&gt;
mail from:&amp;lt;jinyf1998@163.com&amp;gt; &lt;span class=&quot;c&quot;&gt;# input source email address&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 250 Mail OK&lt;/span&gt;
rcpt to:&amp;lt;jyf20@mails.tsinghua.edu.cn&amp;gt; &lt;span class=&quot;c&quot;&gt;# input target email adress&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 250 Mail OK&lt;/span&gt;
data &lt;span class=&quot;c&quot;&gt;# input email content&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 354 End data with &amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;.&amp;lt;CR&amp;gt;&amp;lt;LF&amp;gt;&lt;/span&gt;
subject: hello hawaii
from: &amp;lt;jinyf1998@163.com&amp;gt;
to: &amp;lt;jyf20@mails.tsinghua.edu.cn&amp;gt;

tell me, is some thing eluding you?
sunshine?
Is this not what you expected to see?
If you wanna find out what is behind this cold eyes ...
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 250 Mail OK queued as smtp14,EsCowADnavwKVwVhQPiWxQ--.36143S2 1627740013&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# 这时jyf20@mails.tsinghua.edu.cn会收到来自jinyf1998@163.com的邮件&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;在python中利用smtp发送邮件&quot;&gt;在python中利用SMTP发送邮件&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Send a email contains plain text&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Import required libraries
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;smtplib&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;formataddr&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email.mime.text&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEText&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# define content of the email
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'What is behind this cold eyes'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'plain'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'From'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;formataddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;sender&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'To'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;formataddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;receiver&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;receiver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Subject'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Test Python SMTP'&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# user information for login
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'xxx'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;receiver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'xxx'&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'xxx'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;smtpObj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smtplib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SMTP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; 
&lt;span class=&quot;c1&quot;&gt;# connect to SMTP server
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtpObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;smtp.163.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;    
&lt;span class=&quot;n&quot;&gt;smtpObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  

&lt;span class=&quot;c1&quot;&gt;# send the email
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;smtpObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendmail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;receiver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Attatch a file to the email&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email.utils&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;formataddr&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email.mime.base&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEBase&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email.mime.text&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEText&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email.mime.multipart&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEMultipart&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoders&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEMultipart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'From'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;formataddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;sender&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'To'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;formataddr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;receiver&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;receiver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Subject'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'Test Python SMTP with attachment'&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MIMEText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'hey you'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'plain'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lyric.txt.gz'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rb'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MIMEBase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'application'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'x-gzip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lyric.txt.gz'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_header&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'Content-Disposition'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'attachment'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'lyric.txt.gz'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;encoders&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode_base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# ... send the message as for plain text
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html">Play with SMTP</summary></entry></feed>